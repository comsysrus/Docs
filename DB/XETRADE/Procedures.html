<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="keywords" content="TDM_Report">
        <link rel="stylesheet" type="text/css" media="screen" href="anim.css" title="report">
        <link rel="stylesheet" type="text/css" media="print" href="anim_NoFrames_print.css" title="report">
            <script src="tdmShowDetails.js" type="text/javascript"></script>
        <title>Toad Data Modeler - HTML Report</title>
    </head>

<body onLoad="getUrlItem()"><div class="mainContainer"><div id="headerContainer"><div id="header"><div class="title1"></div><div class="title2">Procedures</div><div class="reportStats">13 января 2021 г. 22:28:33</div><div class="titleimage"><a href="https://www.quest.com/" target="_blank"><img src="Img/logo.png" alt="Made with Toad Data Modeler" border="0" /></a></div><div class="headerEnd"><p>&nbsp;</p></div></div><div id="navTop"><ul><li><a href="MInfo.html">Model Info</a></li><li><a href="MImage.html">ER Diagram</a></li><li><a href="Tables.html">Entities</a></li><li><a href="Columns.html">Attributes</a></li><li><a href="Indexes.html">Indexes</a></li><li><a href="Keys.html">Keys</a></li><li class="selLi"><a href="Procedures.html" class="selAnchor">Procedures</a></li><li><a href="Views.html">Views</a></li><li><a href="ViewRelations.html">View Relationships</a></li><li><a href="Packages.html">Packages</a></li><li><a href="Sequences.html">Sequences</a></li><li><a href="Editions.html">Editions</a></li></ul><div id="navTopEnd"><p>&nbsp;</p></div></div></div><div id="navCombo"><form name="allItems" action=""><select name="listOfItems" onChange="showSelected()"><option value="Proc_{7164E932-BBD1-4447-B5B1-7B49E621534C}">XETRADE.GETACTIVES</option><option value="Proc_{9BA69ED7-81F1-4941-9D9B-AE2BA27C9ABD}">XETRADE.GETMONEYLIMIT</option><option value="Proc_{9BA5B458-7F3A-4673-AAE6-49CF9DF949EA}">XETRADE.GETORDERID</option><option value="Proc_{77889CC0-88E6-49E7-A95D-886BD1252573}">XETRADE.GETPAPERLIMIT</option><option value="Proc_{6251A791-9327-43D3-B1B0-E3D9AD164606}">XETRADE.GETSIGNALSBYSTRATEGYNAME</option><option value="Proc_{E42C9E4B-758A-4C0C-A09C-7524951B6743}">XETRADE.GETSYSTEMS</option><option value="Proc_{E72A2E5D-18BF-40B0-9511-A03608EC07C4}">XETRADE.SENDMAIL</option></select></form><div id="navComboEnd"><p></p></div></div><div id="navLeft"><div id="bookmark"><ul><li><a onClick="return showDetail('Proc_{7164E932-BBD1-4447-B5B1-7B49E621534C}', this)">XETRADE.GETACTIVES</a></li><li><a onClick="return showDetail('Proc_{9BA69ED7-81F1-4941-9D9B-AE2BA27C9ABD}', this)">XETRADE.GETMONEYLIMIT</a></li><li><a onClick="return showDetail('Proc_{9BA5B458-7F3A-4673-AAE6-49CF9DF949EA}', this)">XETRADE.GETORDERID</a></li><li><a onClick="return showDetail('Proc_{77889CC0-88E6-49E7-A95D-886BD1252573}', this)">XETRADE.GETPAPERLIMIT</a></li><li><a onClick="return showDetail('Proc_{6251A791-9327-43D3-B1B0-E3D9AD164606}', this)">XETRADE.GETSIGNALSBYSTRATEGYNAME</a></li><li><a onClick="return showDetail('Proc_{E42C9E4B-758A-4C0C-A09C-7524951B6743}', this)">XETRADE.GETSYSTEMS</a></li><li><a onClick="return showDetail('Proc_{E72A2E5D-18BF-40B0-9511-A03608EC07C4}', this)">XETRADE.SENDMAIL</a></li></ul><div id="bookmarkEnd"><p>&nbsp;</p></div></div></div><div class="separator" ></div><div class="container"><div id="content"><div id="Proc_{7164E932-BBD1-4447-B5B1-7B49E621534C}" class="item">
<a name = "Proc_{7164E932-BBD1-4447-B5B1-7B49E621534C}"></a>
<div class="caption1"><p>XETRADE.GETACTIVES</p></div>
<div class="caption2"><p>General Info</p></div>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead" width="20%">Caption</td>
<td class="tabdata" width="80%">GETACTIVES</td>
</tr>
</table>
<br>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead">Body</td>
</tr>
<tr>
<td class="tabdata"><pre><code>IS<br> BEGIN<br>  SELECT distinct curr_actives INTO actives FROM XETRADE.client_portfolio<br>  WHERE client_code=Getactives.client_code;<br> END Getactives;</code></pre></td>
</tr>
</table>
<br>
<div class="caption2"><p>Procedure Properties</p></div>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead" width="20%">Procedure Arguments</td>
<td class="tabdata" width="80%">client_code IN VARCHAR2, actives OUT NUMBER</td>
</tr>
</table>
<br>
<div class="itemEnd"><p>&nbsp;</p></div></div>
<div id="Proc_{9BA69ED7-81F1-4941-9D9B-AE2BA27C9ABD}" class="item">
<a name = "Proc_{9BA69ED7-81F1-4941-9D9B-AE2BA27C9ABD}"></a>
<div class="caption1"><p>XETRADE.GETMONEYLIMIT</p></div>
<div class="caption2"><p>General Info</p></div>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead" width="20%">Caption</td>
<td class="tabdata" width="80%">GETMONEYLIMIT</td>
</tr>
</table>
<br>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead">Body</td>
</tr>
<tr>
<td class="tabdata"><pre><code>IS<br> tmpLimit NUMBER;<br> BEGIN<br>  SELECT NVL(cur_saldo,0) INTO LIMIT FROM XETRADE.money_limit WHERE<br>   firm=getMoneyLimit.firm  AND client_code=getMoneyLimit.client_code;<br> END getMoneyLimit;</code></pre></td>
</tr>
</table>
<br>
<div class="caption2"><p>Procedure Properties</p></div>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead" width="20%">Procedure Arguments</td>
<td class="tabdata" width="80%">firm IN VARCHAR2, client_code IN VARCHAR2, LIMIT OUT NUMBER</td>
</tr>
</table>
<br>
<div class="itemEnd"><p>&nbsp;</p></div></div>
<div id="Proc_{9BA5B458-7F3A-4673-AAE6-49CF9DF949EA}" class="item">
<a name = "Proc_{9BA5B458-7F3A-4673-AAE6-49CF9DF949EA}"></a>
<div class="caption1"><p>XETRADE.GETORDERID</p></div>
<div class="caption2"><p>General Info</p></div>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead" width="20%">Caption</td>
<td class="tabdata" width="80%">GETORDERID</td>
</tr>
</table>
<br>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead">Body</td>
</tr>
<tr>
<td class="tabdata"><pre><code>IS<br> BEGIN<br>  SELECT XETRADE.order_seq.NEXTVAL INTO orderID FROM dual;<br> END getOrderID;</code></pre></td>
</tr>
</table>
<br>
<div class="caption2"><p>Procedure Properties</p></div>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead" width="20%">Procedure Arguments</td>
<td class="tabdata" width="80%">orderID OUT INTEGER</td>
</tr>
</table>
<br>
<div class="itemEnd"><p>&nbsp;</p></div></div>
<div id="Proc_{77889CC0-88E6-49E7-A95D-886BD1252573}" class="item">
<a name = "Proc_{77889CC0-88E6-49E7-A95D-886BD1252573}"></a>
<div class="caption1"><p>XETRADE.GETPAPERLIMIT</p></div>
<div class="caption2"><p>General Info</p></div>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead" width="20%">Caption</td>
<td class="tabdata" width="80%">GETPAPERLIMIT</td>
</tr>
</table>
<br>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead">Body</td>
</tr>
<tr>
<td class="tabdata"><pre><code>IS<br> BEGIN<br>  SELECT NVL(cur_saldo,0) INTO LIMIT FROM XETRADE.paper_limit WHERE<br>   firm=XETRADE.getPaperLimit.firm AND client_code = XETRADE.getPaperLimit.client_code AND ticker = XETRADE.getPaperLimit.ticker;<br>    EXCEPTION<br>      WHEN NO_DATA_FOUND THEN<br>        LIMIT:=0;<br>      WHEN OTHERS THEN<br>        -- Consider logging the error and then re-raise<br>        RAISE;<br> END GETPAPERLIMIT;</code></pre></td>
</tr>
</table>
<br>
<div class="caption2"><p>Procedure Properties</p></div>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead" width="20%">Procedure Arguments</td>
<td class="tabdata" width="80%">FIRM IN VARCHAR2, CLIENT_Code IN VARCHAR2, ticker IN VARCHAR2, LIMIT OUT NUMBER</td>
</tr>
</table>
<br>
<div class="itemEnd"><p>&nbsp;</p></div></div>
<div id="Proc_{6251A791-9327-43D3-B1B0-E3D9AD164606}" class="item">
<a name = "Proc_{6251A791-9327-43D3-B1B0-E3D9AD164606}"></a>
<div class="caption1"><p>XETRADE.GETSIGNALSBYSTRATEGYNAME</p></div>
<div class="caption2"><p>General Info</p></div>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead" width="20%">Caption</td>
<td class="tabdata" width="80%">GETSIGNALSBYSTRATEGYNAME</td>
</tr>
</table>
<br>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead">Body</td>
</tr>
<tr>
<td class="tabdata"><pre><code>IS<br> BEGIN<br>  XETRADE.trade_pack.getSignalsByStrategyName(strategy_pseudo_name, begin_date, end_date, res);<br> END getSignalsByStrategyName;</code></pre></td>
</tr>
</table>
<br>
<div class="caption2"><p>Procedure Properties</p></div>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead" width="20%">Procedure Arguments</td>
<td class="tabdata" width="80%">strategy_pseudo_name IN VARCHAR2, begin_date IN DATE, end_date IN DATE, res OUT XETRADE.TRADE_PACK.t_crs</td>
</tr>
</table>
<br>
<div class="itemEnd"><p>&nbsp;</p></div></div>
<div id="Proc_{E42C9E4B-758A-4C0C-A09C-7524951B6743}" class="item">
<a name = "Proc_{E42C9E4B-758A-4C0C-A09C-7524951B6743}"></a>
<div class="caption1"><p>XETRADE.GETSYSTEMS</p></div>
<div class="caption2"><p>General Info</p></div>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead" width="20%">Caption</td>
<td class="tabdata" width="80%">GETSYSTEMS</td>
</tr>
</table>
<br>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead">Body</td>
</tr>
<tr>
<td class="tabdata"><pre><code>IS<br> BEGIN<br>  XETRADE.trade_pack.getPseudoStrategies(username, res);<br> END getSystems;</code></pre></td>
</tr>
</table>
<br>
<div class="caption2"><p>Procedure Properties</p></div>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead" width="20%">Procedure Arguments</td>
<td class="tabdata" width="80%">username IN VARCHAR2, res OUT XETRADE.TRADE_PACK.t_crs</td>
</tr>
</table>
<br>
<div class="itemEnd"><p>&nbsp;</p></div></div>
<div id="Proc_{E72A2E5D-18BF-40B0-9511-A03608EC07C4}" class="item">
<a name = "Proc_{E72A2E5D-18BF-40B0-9511-A03608EC07C4}"></a>
<div class="caption1"><p>XETRADE.SENDMAIL</p></div>
<div class="caption2"><p>General Info</p></div>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead" width="20%">Caption</td>
<td class="tabdata" width="80%">SENDMAIL</td>
</tr>
</table>
<br>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead">Body</td>
</tr>
<tr>
<td class="tabdata"><pre><code>is<br> er varchar2(4000);<br> c           utl_smtp.connection;<br> smessage   varchar2(1600)  := s_message;<br> smailhost  VARCHAR2(80)    := 'smtp.yandex.ru';<br> ssender    varchar2(30);<br> spassword  varchar2(30);<br> spam_id integer;<br> FUNCTION MIMEHEADER_ENCODE(s_string VARCHAR2) RETURN VARCHAR2<br> IS<br> BEGIN<br> RETURN '=?windows-1251?B?' ||<br> utl_raw.cast_to_varchar2 (<br>                         utl_encode.base64_encode<br>                                               (<br>                                               utl_raw.cast_to_raw( convert(s_string, 'CL8MSWIN1251') )<br>                                               )<br>                         )<br>                           ||'?=';<br> END;<br> BEGIN<br> select id,account_name,password into spam_id,ssender,spassword from XETRADE.spam_accounts where (id=(select max(id) from XETRADE.spam_accounts where status='???????'));<br> update XETRADE.spam_accounts set tryes=tryes+1 where id=spam_id;<br> commit;<br> update XETRADE.spam_accounts set status='??????-???!!!' where tryes&gt;=90;<br> commit;<br> smessage := s_message||chr(10)||chr(10)||'?? ??? ?????? ???????? ?? ????.'||CHR(10);<br> c := utl_smtp.open_connection(smailhost);<br> utl_smtp.helo(c, smailhost);<br> <br>   utl_smtp.command(c, 'AUTH LOGIN');<br>   utl_smtp.command(<br>       c<br>     , utl_raw.cast_to_varchar2(<br>         utl_encode.base64_encode(utl_raw.cast_to_raw(ssender))<br>       )<br>   );<br>   utl_smtp.command(<br>       c<br>     , utl_raw.cast_to_varchar2(<br>         utl_encode.base64_encode(utl_raw.cast_to_raw('57ok98lq'))<br>       )<br>   );  <br> <br> utl_smtp.mail(c, ssender);<br> utl_smtp.rcpt(c, s_recipient);<br> utl_smtp.open_data(c);<br> utl_smtp.write_raw_data(c, utl_raw.cast_to_raw('From: '||convert('?????&lt;'||s_sender||'&gt;', 'CL8MSWIN1251')|| utl_tcp.CRLF));<br> utl_smtp.write_raw_data(c, utl_raw.cast_to_raw('To: '||s_recipient||utl_tcp.CRLF));<br> utl_smtp.write_raw_data(c, utl_raw.cast_to_raw('Subject: '|| MIMEHEADER_ENCODE(s_subject) || utl_tcp.CRLF));<br> utl_smtp.write_raw_data(c, utl_raw.cast_to_raw('Content-Type: text/plain; charset=&quot;windows-1251&quot;'||utl_tcp.CRLF));<br> utl_smtp.write_raw_data(c, utl_raw.cast_to_raw(utl_tcp.CRLF||convert(s_message, 'CL8MSWIN1251')));<br> utl_smtp.close_data(c);<br> utl_smtp.quit(c);<br> exception when OTHERS then<br> BEGIN<br> --  utl_smtp.quit(c);<br> 	er := SQLERRM;<br> 	 insert into XETRADE.error_log(id,message)<br>   values (XETRADE.main_seq.nextval,er);<br>   end;<br> END;</code></pre></td>
</tr>
</table>
<br>
<div class="caption2"><p>Procedure Properties</p></div>
<table class="tabformat" border="0" cellpadding="2" cellspacing="1" width="100%">
<tr>
<td class="tabhead" width="20%">Procedure Arguments</td>
<td class="tabdata" width="80%">s_sender    in varchar2 := null,<br>     s_recipient  in varchar2,<br>     s_subject   in varchar2,<br>     s_message in varchar2<br> </td>
</tr>
</table>
<br>
<div class="itemEnd"><p>&nbsp;</p></div></div>
</div><div id="footer"><div class="pageFooter">Copyright &copy; Sitename 2005</div><div class="footerEnd"><p></p></div></div></div></div></body></html>
